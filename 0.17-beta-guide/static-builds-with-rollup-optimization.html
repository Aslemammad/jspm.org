<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Static Builds with Rollup Optimization | jspm 0.17 Beta Guide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.3">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./publishing.html" />
    
    
    <link rel="prev" href="./custom-package-resolutions.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="11"
        data-chapter-title="Static Builds with Rollup Optimization"
        data-filepath="static-builds-with-rollup-optimization.md"
        data-basepath="."
        data-revision="Mon Feb 27 2017 09:57:14 GMT+0200 (SAST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="creating-a-project.html">
            
                
                    <a href="./creating-a-project.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Creating a Project
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="development-bundling.html">
            
                
                    <a href="./development-bundling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Development Bundling
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="hot-reloading.html">
            
                
                    <a href="./hot-reloading.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Hot-Reloading
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="package-configuration.html">
            
                
                    <a href="./package-configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Package Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="installing-the-jsx-babel-plugin.html">
            
                
                    <a href="./installing-the-jsx-babel-plugin.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Installing the JSX Babel Plugin
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="universal-js-with-server-rendering.html">
            
                
                    <a href="./universal-js-with-server-rendering.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Universal JS with Server Rendering
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="npm-package-support.html">
            
                
                    <a href="./npm-package-support.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        npm Package Support
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="bundling.html">
            
                
                    <a href="./bundling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Bundling
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="loading-libraries-from-cdn.html">
            
                
                    <a href="./loading-libraries-from-cdn.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Loading Libraries from CDN
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="custom-package-resolutions.html">
            
                
                    <a href="./custom-package-resolutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Custom Package Resolutions
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="11" data-path="static-builds-with-rollup-optimization.html">
            
                
                    <a href="./static-builds-with-rollup-optimization.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        Static Builds with Rollup Optimization
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="publishing.html">
            
                
                    <a href="./publishing.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        Publishing
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="peer-dependencies.html">
            
                
                    <a href="./peer-dependencies.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        Peer Dependencies
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="linking.html">
            
                
                    <a href="./linking.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        Linking
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="overrides.html">
            
                
                    <a href="./overrides.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        Overrides
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="conditional-loading.html">
            
                
                    <a href="./conditional-loading.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        Conditional Loading
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="17" data-path="conditional-substitution.html">
            
                
                    <a href="./conditional-substitution.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        Conditional Substitution
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >jspm 0.17 Beta Guide</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="static-builds-with-rollup-optimization">Static Builds with Rollup Optimization</h2>
<p>To build our component for use in other projects, we can use the SystemJS static build to create
an optimized component file to share.</p>
<p>This is handled via <code>jspm build</code> in jspm which takes similar arguments to <code>jspm bundle</code>, but instead of storing
a registry entry for each module, it will try to fully optimize the inter-module dependencies.</p>
<p>Whenever there are sub-trees of ES modules within the build tree, SystemJS Builder will inline any of these trees together
using <a href="http://rollupjs.org" target="_blank">Rollup</a>. This allows unused exports to be removed via code tree analysis.
If the whole module tree consists only of ES modules, then the entire tree can be inlined with Rollup, giving the 
best possible code optimization.</p>
<blockquote>
<p>In case it is not already obvious, <a href="http://rollupjs.org" target="_blank">Rollup</a> is amazing.</p>
</blockquote>
<p>Let&apos;s create a <code>dist</code> folder then output a built component into this folder:</p>
<pre><code>jspm build jspm-react-component/component.js dist/jspm-react-component.js \
  --externals react
  --format umd --global-name jspmReactComponent --global-deps &quot;{&apos;react&apos;:&apos;React&apos;}&quot; --skip-source-maps
</code></pre><p>To break down the options we&apos;ve provided:</p>
<ul>
<li>On the first line, we indicate we want to build the module <code>jspm-react-component/component.js</code>
into the output build file <code>dist/jspm-react-component.js</code>.</li>
<li><code>--externals react</code> indicates that React should be excluded from the build as a dependency.</li>
<li><code>--format umd</code> outputs a built file that will work as AMD, CommonJS or a global.</li>
<li><code>--global-name jspmReactComponent</code> means that when running as a global, it will create <code>global.jspmReactComponent</code>
as the value of <code>jspm-react-component</code></li>
<li><code>--global-deps &quot;{&apos;react&apos;:&apos;React&apos;}&quot;</code> indicates that our dependency on <code>react</code> should refer to the global <code>React</code>
when running as a global.</li>
<li><code>--skip-source-maps</code> since we don&apos;t need references to the original sources anymore we can skip source map generation.</li>
</ul>
<p><em>Neither <code>--global-name</code> nor <code>--global-deps</code> would have been necessary if running a CJS, AMD or ESM format build.</em></p>
<p>We should then see the following output in the console:</p>
<pre><code>     Creating the single-file build for jspm-react-component/component.js...

       &#x250C;&#x2500; jspm-react-component/component.js
       &#x251C;&#x2500; npm:systemjs-plugin-babel@0.0.12/babel-helpers/classCallCheck.js
       &#x251C;&#x2500; npm:systemjs-plugin-babel@0.0.12/babel-helpers/possibleConstructorReturn.js
       &#x251C;&#x2500; npm:systemjs-plugin-babel@0.0.12/babel-helpers/createClass.js
       &#x2514;&#x2500; npm:systemjs-plugin-babel@0.0.12/babel-helpers/inherits.js

ok   Fully-optimized - entire tree built via Rollup static optimization.

ok   Built into dist/jspm-react-component.js, unminified as umd.
</code></pre><p><em>Fully-optimized</em> indicates that the entire tree has been built with Rollup, including
inlining the Babel transform helpers.</p>
<p>The full output of this file can be seen at <a href="https://github.com/guybedford/jspm-react-component-demo/blob/master/dist/jspm-react-component.js" target="_blank">https://github.com/guybedford/jspm-react-component-demo/blob/master/dist/jspm-react-component.js</a>.</p>
<blockquote>
<p>By default builds, like bundles, build for the browser in production. We can pass the <code>--node</code> or <code>--dev</code>
options to both the build and bundle commands to build the Node and development conditional paths respectively.
These conditional loading techniques are covered in the <a href="conditional-loading.html">last two sections</a>.</p>
</blockquote>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./custom-package-resolutions.html" class="navigation navigation-prev " aria-label="Previous page: Custom Package Resolutions"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./publishing.html" class="navigation navigation-next " aria-label="Next page: Publishing"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"ga":{"token":"UA-40327700-1","configuration":"auto"},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
